{#
  Bootstrap 5-styled local task item
  FIX: Render the 'link' first to avoid strtr() type errors when it's a render array.
#}
{# Variables: attributes (Attribute object), link (render array or markup), is_active (bool) #}
{% set li_classes = ['nav-item'] %}

<li{{ attributes.addClass(li_classes).setAttribute('role','presentation') }}>
  {# Ensure we have a string to operate on, not an array #}
  {% set rendered_link = link|render %}
  {% set injected = rendered_link|replace({'<a ': '<a class="nav-link' ~ (is_active ? ' active' : '') ~ '" role="tab" '}) %}
  {{ injected|raw }}
</li>
